# スマホで完結！Google Apps Scriptで作る始業前点検システム

製造現場や工場で毎日行われる「始業前点検」。チェックシートに手書きで記録して、不具合があったら別途報告書を作って...と、意外と手間がかかっていませんか？

そんな悩みを解決する、**スマホのGoogleフォームだけで完結する始業前点検システム**を作ってみました。不適合項目があると自動で是正依頼を起票してくれる、なかなか便利なヤツです。

## どんなシステム？

### 基本的な仕組み
- **スマホでGoogleフォームに入力**（設備ID、点検者、各チェック項目など）
- **適合なら何もしない**（記録だけ残る）
- **不適合があると自動でissuesシートに起票**
- **メール通知も飛ばせる**（設定すれば）

### こんな感じで使います
1. 作業者がスマホで「潤滑油量：不適合、安全カバー：適合...」と入力
2. 送信ボタンをポチッ
3. 裏側でGoogle Apps Scriptが動いて、不適合項目だけissuesシートに自動記録
4. 管理者にメール通知「設備Aで潤滑油量の不適合が発生しました」

**これだけ**。シンプルでしょ？

## 何がスゴいの？

### 1. **重複起票を防ぐ賢い仕組み**
同じ回答を編集・再送信しても、重複して起票されません。タイムスタンプと設備IDで一意性をチェックしているので、「あれ、これ前に報告したっけ？」問題が起きません。

### 2. **柔軟なチェック項目設定**
「潤滑油量」「安全カバー」「異音」以外にも、フォームにチェック項目を追加するだけでOK。コードをいじる必要なし。現場のニーズに合わせて自由に拡張できます。

### 3. **自動完了日記録**
issuesシートで状態を「完了」に変えると、完了日が自動で入ります。地味だけど、後から「いつ直したっけ？」を調べるときに便利。

### 4. **設定は全部外出し**
- 通知メールアドレス
- 期限日数（デフォルト7日だけど変更可能）

これらはScript Propertiesに保存されているので、コードを触らずに設定変更できます。

## 導入で得られるメリット

### 省力化効果
**従来の手順**：
1. 紙のチェックシートに手書き記入
2. 不適合があったら別途報告書作成
3. 管理者に手渡し or FAX送信
4. 管理者がExcelに転記
5. 期限管理も手動

**導入後**：
1. スマホでフォーム入力（30秒）
2. **以降は全自動**

作業時間を **90%削減** できます。1日10件の点検があれば、1日あたり約1時間の工数削減。年間だと約250時間の省力化です。

### 省人化効果
- **転記作業が不要**：管理者の事務作業が激減
- **見落とし防止**：不適合項目の報告漏れがゼロに
- **期限管理自動化**：「あの件どうなった？」の確認作業が不要

管理者1人あたり、月20時間程度の業務時間短縮が見込めます。

### データ活用効果
全ての点検データがスプレッドシートに蓄積されるので：
- **トレンド分析**：「この設備、最近不具合多いな」が数値で見える
- **予防保全**：過去データから故障パターンを予測
- **監査対応**：「○月○日の点検記録を出して」に即答

## 使い方（導入手順）

### 1. Googleフォーム作成
以下の質問項目でフォームを作成：
- 設備ID（記述）
- 点検者（記述）
- 点検日（日付）
- 潤滑油量（選択肢：適合/不適合/N/A）
- 安全カバー（選択肢：適合/不適合/N/A）
- 異音（選択肢：適合/不適合/N/A）
- 備考（段落）

### 2. スプレッドシートにリンク
フォームの回答をスプレッドシートに保存する設定をONに。

### 3. Apps Scriptのコードを設置
スプレッドシートから「拡張機能→Apps Script」でエディタを開いて、提供されているCode.gsをコピペ。

### 4. トリガー設定
「フォーム送信時」のトリガーを設定して、onFormSubmit関数が自動実行されるようにします。

### 5. 必要に応じて通知設定
```javascript
setNotificationEmail('manager@company.com');
```
を実行すれば、不適合発生時にメール通知が飛びます。

## 実際に使ってみた感想

**作業者側**：
「スマホで入力するだけだから楽。紙に書くより早いし、字が汚くて読めない問題もない」

**管理者側**：
「不適合の見落としがなくなったのが一番大きい。あと、期限管理が自動化されて精神的にもラク」

**経営側**：
「月次で不適合件数の推移がグラフで見えるようになって、改善活動のPDCAが回しやすくなった」

## まとめ

このシステムの良いところは、**シンプルで壊れにくい**こと。Google Apps ScriptとGoogleフォームだけで構成されているので、サーバー管理も不要だし、メンテナンスもほぼゼロ。

中小企業でも気軽に導入できて、確実に業務効率化できるシステムです。紙ベースの点検業務で困っている現場があったら、ぜひ試してみてください。

工数削減もさることながら、「人間のうっかりミス」がなくなるのが一番の価値かもしれません。デジタル化って、こういう「当たり前だけど面倒な作業」を楽にするためにあるんだなと、改めて感じました。