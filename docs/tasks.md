# タスク一覧

## 実装タスク

### T001: ユーティリティ関数群の実装 [優先度: 高]
**状態**: 未着手  
**内容**: 
- addDays_(date, days): 日付加算処理
- formatDate_(date): yyyy-MM-dd形式変換
- generateUuid_(): 8桁UUID断片生成
- generateUniqueKey_(timestamp, equipmentId): 重複防止キー生成
- getDeadlineDays_(): DEFAULT_DEADLINE_DAYS取得
- setNotificationEmail(email): Script Properties設定

**受け入れ条件**:
- 日付計算が正確に動作する
- フォーマットがyyyy-MM-dd形式になる
- UUIDが8桁の英数字になる
- Script Propertiesに正しく保存される

### T002: データ処理モジュールの実装 [優先度: 高]
**状態**: 未着手  
**内容**:
- extractFormData(namedValues): メタ項目とチェック項目の分離
- isNonCompliant(answer): NG判定ロジック

**受け入れ条件**:
- メタ項目集合による正確な分離ができる
- 「不適合」「ng」「×」「x」のNG判定が動作する
- 空文字・null値に対して安全に動作する
- 設備ID欠損時は処理を中止し警告ログを出力する

### T003: Issues管理モジュールの実装 [優先度: 高]
**状態**: 未着手  
**内容**:
- createOrGetIssuesSheet(spreadsheet): シート存在確認・作成
- checkDuplicateIssue_(sheet, uniqueKey): 既存issuesの重複チェック
- addIssueRecord(sheet, formData, nonCompliantItems): 行データ追加

**受け入れ条件**:
- issuesシートが存在しない場合に新規作成される
- ヘッダ行が1回だけ追加される
- 指定フォーマットで行データが正しく追加される
- 重複キーで既存issuesを正しくチェックできる

### T004: 通知モジュールの実装 [優先度: 中]
**状態**: 未着手  
**内容**:
- sendNotification(formData, nonCompliantItems, sheetUrl): メール通知送信（URL含む）

**受け入れ条件**:
- NOTIFICATION_EMAIL設定時のみ実行される
- 不適合項目を含む適切なメール内容になる
- issuesシートURLがメール本文に含まれる
- 送信エラー時にログが出力される

### T005: メイン処理の実装 [優先度: 高]
**状態**: 未着手  
**内容**:
- onFormSubmit(e): フォーム送信イベントハンドラー
- 全モジュールの統合処理

**受け入れ条件**:
- e/e.namedValues欠落時に適切に終了する
- データ抽出からissues起票まで一連の処理が動作する
- 重複キーチェックで重複起票を正しく防止できる
- エラー発生時もスクリプトが停止しない

### T006: コード品質の確保 [優先度: 中]
**状態**: 未着手  
**内容**:
- 日本語コメントの追加
- JSDoc風説明の付与
- エラーハンドリングの強化

**受け入れ条件**:
- 全ての関数に日本語コメントがある
- 主要関数にJSDoc形式の説明がある
- 例外処理が適切に実装されている

## テストタスク

### T007: 正常系テストの準備 [優先度: 低]
**状態**: 未着手  
**内容**:
- 適合回答のテストデータ作成
- 不適合回答のテストデータ作成
- 混在パターンのテストデータ作成

### T008: 異常系テストの準備 [優先度: 低]
**状態**: 未着手  
**内容**:
- 不正入力値のテストケース
- メタ項目欠損のテストケース
- シート操作エラーのテストケース

## デプロイタスク

### T009: srcディレクトリの構成確認 [優先度: 低]
**状態**: 未着手  
**内容**:
- Code.gsファイルの配置確認
- clasp設定ファイルの確認

### T010: 重複ガード実装 [優先度: 高]
**状態**: 未着手  
**内容**:
- 一意キー生成ロジック
- 既存issuesのキー検索処理
- 重複時のスキップ処理

**受け入れ条件**:
- Timestamp + 設備IDの一意キーが正しく生成される
- 重複キー検索が効率的に動作する
- 重複時は早期にreturnして処理を終了する

### T011: 状態管理拡張機能 [優先度: 低]
**状態**: 未着手  
**内容**:
- onEditトリガーで状態=完了時に完了日自動記録

**受け入れ条件**:
- 状態列の変更を正しく検知できる
- 完了日が当日日付で自動記録される

## 実行順序
1. **Phase 1**: T001, T002 (並行実行可能)
2. **Phase 2**: T003, T010 (T001完了後)
3. **Phase 3**: T004 (T001完了後)
4. **Phase 4**: T005 (全依存タスク完了後)
5. **Phase 5**: T006 (T005完了後)
6. **Phase 6**: T007, T008, T009, T011 (必要に応じて)

## 見積もり
- **Phase 1-3 (コア実装)**: 実装優先
- **Phase 4 (品質確保)**: 実装優先  
- **Phase 5 (テスト・デプロイ)**: 時間があれば実施

## リスク・注意事項
- Google Apps Scriptの実行時制限（6分）
- スプレッドシート操作の API 制限
- メール送信の日次制限
- タイムゾーン設定の確認が必要